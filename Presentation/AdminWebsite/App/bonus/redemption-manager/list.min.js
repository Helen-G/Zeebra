(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}};define(["nav","durandal/app","shell","bonus/bonusCommon","i18next","controls/grid"],function(t,i,r,u,f){return function(){function e(){this.detached=n(this.detached,this);this.compositionComplete=n(this.compositionComplete,this);this.shell=r;this.playerId=ko.observable(null);this.redemptionId=ko.observable(null);this.search=ko.observable("");this.canBeCanceled=ko.observable(!1)}return e.prototype.activationFormatter=function(){return u.redemptionActivationFormatter(this.ActivationState)},e.prototype.rolloverFormatter=function(){return u.redemptionRolloverFormatter(this.RolloverState)},e.prototype.reloadGrid=function(){return $("#redemption-grid").trigger("reload")},e.prototype.compositionComplete=function(){$("#redemption-grid").on("gridLoad selectionChange",function(n){return function(t,i){return n.redemptionId(i.id),n.playerId(i.data.PlayerId),n.canBeCanceled(i.data.RolloverState==="Active")}}(this));$("#redemption-search").submit(function(n){return function(){return n.search($("#redemption-username-search").val()),!1}}(this));return $(document).on("redemptions_changed",this.reloadGrid)},e.prototype.detached=function(){return $(document).off("redemptions_changed",this.reloadGrid)},e.prototype.openViewTab=function(){if(this.redemptionId())return t.open({path:"bonus/redemption-manager/view-redemption",title:f.t("bonus.redemptionManager.view"),data:{playerId:this.playerId(),redemptionId:this.redemptionId()}})},e.prototype.cancel=function(){if(this.redemptionId())return i.showMessage(f.t("bonus.messages.cancelRedemption"),f.t("bonus.messages.confirmCancellation"),[{text:f.t("common.booleanToYesNo.true"),value:!0},{text:f.t("common.booleanToYesNo.false"),value:!1}],!1,{style:{width:"450px"}}).then(function(n){return function(t){if(t)return $.post("/Redemption/Cancel",{playerId:n.playerId(),redemptionId:n.redemptionId()}).done(function(t){return t.Success?($(document).trigger("redemptions_changed"),n.canBeCanceled(!1),i.showMessage(f.t("bonus.messages.canceledSuccessfully"),f.t("bonus.redemptionManager.cancel"),[f.t("common.close")])):i.showMessage(t.Message,f.t("common.error"),[f.t("common.close")])})}}(this))},e}()})}).call(this);
//# sourceMappingURL=list.min.js.map
