(function(){var n=function(n,t){return function(){return n.apply(t,arguments)}};define(["nav","durandal/app","i18next","security/security","shell","bonus/bonusCommon","controls/grid"],function(t,i,r,u,f,e){return function(){function o(){this.detached=n(this.detached,this);this.compositionComplete=n(this.compositionComplete,this);this.shell=f;this.templateId=ko.observable();this.canBeEditedDeleted=ko.observable(!1);this.complete=ko.observable(!1);this.search=ko.observable("")}return o.prototype.typeFormatter=function(){return e.typeFormatter(this.Type)},o.prototype.statusFormatter=function(){return r.t("bonus.templateStatuses."+this.Status)},o.prototype.issuanceModeFormatter=function(){return e.issuanceModeFormatter(this.Mode)},o.prototype.isAddBtnVisible=ko.computed(function(){return u.isOperationAllowed(u.permissions.add,u.categories.bonusTemplateManager)}),o.prototype.isEditBtnVisible=ko.computed(function(){return u.isOperationAllowed(u.permissions.edit,u.categories.bonusTemplateManager)}),o.prototype.isDeleteBtnVisible=ko.computed(function(){return u.isOperationAllowed(u.permissions["delete"],u.categories.bonusTemplateManager)}),o.prototype.isViewBtnVisible=ko.computed(function(){return u.isOperationAllowed(u.permissions.view,u.categories.bonusTemplateManager)}),o.prototype.openAddTemplateTab=function(){return t.open({path:"bonus/template-manager/wizard",title:r.t("bonus.templateManager.new")})},o.prototype.openEditTemplateTab=function(){if(this.templateId())return t.open({path:"bonus/template-manager/wizard",title:r.t("bonus.templateManager.edit"),data:{id:this.templateId(),complete:this.complete()}})},o.prototype.openViewTemplateTab=function(){if(this.templateId())return t.open({path:"bonus/template-manager/wizard",title:r.t("bonus.templateManager.view"),data:{id:this.templateId(),view:!0}})},o.prototype.deleteTemplate=function(){if(this.templateId())return i.showMessage(r.t("bonus.messages.deleteTemplate"),r.t("bonus.messages.confirmTemplateDeletion"),[{text:r.t("common.booleanToYesNo.true"),value:!0},{text:r.t("common.booleanToYesNo.false"),value:!1}],!1,{style:{width:"350px"}}).then(function(n){return function(t){if(t)return $.post("/BonusTemplate/Delete",{templateId:n.templateId()}).done(function(t){return t.Success?($(document).trigger("bonus_templates_changed"),n.canBeEditedDeleted(!1),i.showMessage(r.t("bonus.messages.deletedSuccessfully"),r.t("bonus.templateManager.delete"),[r.t("common.close")])):i.showMessage(t.Errors[0].ErrorMessage,r.t("common.error"),[r.t("common.close")])})}}(this))},o.prototype.reloadGrid=function(){return $("#bonus-template-grid").trigger("reload")},o.prototype.compositionComplete=function(){$("#bonus-template-grid").on("gridLoad selectionChange",function(n){return function(t,i){return n.templateId(i.id),n.canBeEditedDeleted(i.data.UsedInBonuses==="false"),n.complete(i.data.Status===r.t("bonus.templateStatuses.1"))}}(this));$("#bonus-template-search").submit(function(n){return function(){return n.search($("#template-name-search").val()),!1}}(this));return $(document).on("bonus_templates_changed",this.reloadGrid)},o.prototype.detached=function(){return $(document).off("bonus_templates_changed",this.reloadGrid)},o}()})}).call(this);
//# sourceMappingURL=list.min.js.map
