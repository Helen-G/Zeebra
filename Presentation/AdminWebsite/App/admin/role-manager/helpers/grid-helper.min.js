(function(){define(function(n){return function(){function t(){var r,f,u,t,i,e,o;for(o=function(n){var u,e,i,t,r,o,f;for(t=[],f=Math.random(),o={id:f,name:"Root"},t.push(o),u=0,e=n.length;u<e;u++)r=n[u],i=ko.utils.arrayFirst(t,function(n){return n.name===r.module}),i==null&&(i={id:Math.random(),name:r.module,module:"Root",parentId:f},t.push(i)),r.parentId=i.id,t.push(r);return t},e=n("security/security"),this.roles=o(e.operations()),console.log("transformed roles"),console.log(this.roles),u=this.roles,r=0,f=u.length;r<f;r++){for(t=u[r],t.sortkey=t.name.toLowerCase(),t.level=0,i=t;i.parentId!=null;)i=ko.utils.arrayFirst(this.roles,function(n){return n.id===i.parentId}),t.sortkey=i.name.toLowerCase()+"-"+t.sortkey,t.level++;t.expanded=!0}this.roles.sort(function(n,t){return n.sortkey<t.sortkey?-1:n.sortkey>t.sortkey?1:0})}return t.prototype.init=function(n){return this.grid=n,$(function(n){return function(){var i,o,r,u,e,f,t;return o=0,i=0,$("input[type=checkbox]",n.grid).click(function(){var i,r,u,t,n;for(n=$(this).parents("tr"),u=n.find("td:eq(1)").text(),i=$(this).is(":checked"),t=[];(n=n.next()).length;){if(r=n.find("td:eq(1)").text(),r<=u)break;t.push($("input[type=checkbox]",n).prop("checked",i))}return t}),f=function(n){return $("td:eq(1)",t(n)).text()||void 0},e=function(n){var i;return(i=$("td:eq(2)",t(n)).text())!==""?i.split(","):[]},t=function(n){return $("tr",this.grid).filter(function(){return $("td:first",this).text()===n})},r=function(n){return $("input[type=checkbox]",t(n))},u=function(n){var h,c,t,l,o,s;return t=r(n),l=t.is(":checked"),o=e(n),h=function(){var n,i,t;for(t=[],n=0,i=o.length;n<i;n++)c=o[n],t.push(r(c).is(":checked"));return t}().every(function(n){return n}),l!==h&&(i++,t.click(),i--,s=f(n),s!=null)?u(s):void 0},$("input[type=checkbox]",n.grid).each(function(){return $(this).addClass($(this).parents("tr").find("td:eq(3)").text())}),$("input[type=checkbox]:checked",n.grid).each(function(){var n,t;return n=$(this).parents("tr").find("td:first").text(),(t=f(n))!=null?u(t):void 0})}}(this))},t.prototype.getChecked=function(){var n;return n=[],console.log("getChecked"),$("input[type=checkbox]",this.grid).each(function(){var t;return t=$(this).parents("tr"),$(this).is(":checked")&&$("td:eq(1)",t).text()==="2"?n.push($("td:first",t).text()):void 0}),n},t.prototype.reload=function(){return this.grid.trigger("reload")},t.prototype.reset=function(){return $("input[type=checkbox]",this.grid).each(function(){return $(this).attr("checked",!1)})},t.prototype.filter=function(n){var i,t;return n=n.trim(),t=[],i=0,$($("input[type=checkbox]",this.grid).get().reverse()).each(function(){var a,u,h,v,c,l,o,y,r,p,f,e,s;if(s=$(this).parents("tr"),typeof r!="undefined"&&r!==null&&(i=r),r=Number(s.find("td:eq(1)").text()),f=s.find("td:eq(3)"),e=f.text(),p=new RegExp("("+n+")","i"),o=Boolean(e.match(p)),l=r>=i,l&&(t.length=r+1),y=l?o:o||t[r+1],o?(c=p.exec(e).index,h=e.substr(0,c)+"<em>"+e.substr(c,n.length)+"<\/em>"+e.substr(c+n.length)):h=e,$("span+span",f).length?$("span+span",f).html(h):(v=$("span",f).html(),$(">span",f).html(v.substr(0,v.lastIndexOf(">")+1)),$(">span",f).append($("<span>").html(h))),o&&!l)for(u=s.next(),a=Number(u.find("td:eq(1)").text());u.length&&a>r;)u.show(),u=u.next(),a=Number(u.find("td:eq(1)").text());return t[r]=y||t[r],i=r,s.toggle(y)})},t}()})}).call(this);
//# sourceMappingURL=grid-helper.min.js.map
