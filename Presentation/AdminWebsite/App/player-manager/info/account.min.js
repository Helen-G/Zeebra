(function(){define(["i18next","player-manager/send-new-password-dialog","security/security","player-manager/change-vip-level-dialog","config"],function(n,t,i,r,u){return function(){function f(){var t;t=this;this.firstName=ko.observable().extend({required:!0,minLength:1,maxLength:50}).extend({pattern:{message:"Invalid First Name",params:"^[A-Za-z0-9]+(?:[ .'-][A-Za-z0-9]+)*$"}});this.lastName=ko.observable().extend({required:!0,minLength:1,maxLength:20}).extend({pattern:{message:"Invalid Last Name",params:"^[A-Za-z0-9]+(?:[ ._'-][A-Za-z0-9]+)*$"}});this.dateOfBirth=ko.observable().extend({required:!0});this.title=ko.observable();this.titles=ko.observable();this.gender=ko.observable();this.genders=ko.observable();this.email=ko.observable().extend({required:!0,email:!0,minLength:1,maxLength:50});this.phoneNumber=ko.observable().extend({required:!0,number:!0,minLength:8,maxLength:15});this.mailingAddressLine1=ko.observable().extend({required:!0,minLength:1,maxLength:50});this.mailingAddressLine2=ko.observable().extend({maxLength:50});this.mailingAddressLine3=ko.observable().extend({maxLength:50});this.mailingAddressLine4=ko.observable().extend({maxLength:50});this.mailingAddressCity=ko.observable();this.mailingAddressPostalCode=ko.observable().extend({required:!0,minLength:1,maxLength:10});this.physicalAddressLine1=ko.observable().extend({required:!0,minLength:1,maxLength:50});this.physicalAddressLine2=ko.observable().extend({maxLength:50});this.physicalAddressLine3=ko.observable().extend({maxLength:50});this.physicalAddressLine4=ko.observable().extend({maxLength:50});this.physicalAddressCity=ko.observable();this.physicalAddressPostalCode=ko.observable().extend({required:!0,minLength:1,maxLength:10});this.securityQuestion=ko.observable();this.securityAnswer=ko.observable();this.country=ko.observable();this.countryName=ko.computed(function(){var n;return n=t.country(),n?n.name():null});this.countries=ko.observableArray();this.contactPreference=ko.observable();this.contactMethods=ko.observable();this.accountAlertEmail=ko.observable(!1);this.accountAlertSms=ko.observable(!1);this.accountAlertsText=ko.computed(function(n){return function(){var t;return t=[],n.accountAlertEmail()&&t.push("Email"),n.accountAlertSms()&&t.push("Sms"),t.length>0?t.join(", "):"None"}}(this)).extend({validation:{validator:function(n){return function(){return n.accountAlertEmail()||n.accountAlertSms()}}(this),message:n.t("app:playerManager.error.accountAlertsEmpty"),params:!0}});this.marketingAlertEmail=ko.observable();this.marketingAlertSms=ko.observable();this.marketingAlertPhone=ko.observable();this.marketingAlertsText=ko.computed(function(n){return function(){var t;return t=[],n.marketingAlertEmail()&&t.push("Email"),n.marketingAlertSms()&&t.push("Sms"),n.marketingAlertPhone()&&t.push("Phone"),t.length>0?t.join(", "):"None"}}(this)).extend({validation:{validator:function(n){return function(){return n.marketingAlertEmail()||n.marketingAlertSms()||n.marketingAlertPhone()}}(this),message:n.t("app:playerManager.error.accountAlertsEmpty"),params:!0}});this.paymentLevel=ko.observable();this.paymentLevels=ko.observable();this.paymentLevelName=ko.computed(function(){var n;return n=t.paymentLevel(),n?n.name():null});this.registrationDate=ko.observable();this.brand=ko.observable();this.currency=ko.observable();this.culture=ko.observable();this.vipLevel=ko.observable();this.vipLevels=ko.observableArray();this.vipLevelCode=ko.computed(function(){var n;return n=t.vipLevel(),n?n.code():null});this.vipLevelName=ko.computed(function(){var n;return n=t.vipLevel(),n?n.name():null});this.playerId=ko.observable();this.activated=ko.observable();this.detailsEditMode=ko.observable(!1);this.fullName=ko.observable();this.username=ko.observable();this.isEditBtnVisible=ko.computed(function(){return i.isOperationAllowed(i.permissions.edit,i.categories.playerManager)});this.isSetStatusBtnVisible=ko.computed(function(){var n;return n=t.activated(),!n&&i.isOperationAllowed(i.permissions.activate,i.categories.playerManager)||n&&i.isOperationAllowed(i.permissions.deactivate,i.categories.playerManager)});this.activateButtonText=ko.computed(function(){return t.activated()?"Deactivate":"Activate"},this);this.canAssignVipLevel=ko.computed(function(){return i.isOperationAllowed(i.permissions.assignVipLevel,i.categories.playerManager)});this.initialData={}}return f.prototype.activate=function(n){var t;return t=this,this.playerId(n.playerId),$.get("/PlayerInfo/Get",{id:this.playerId()}).done(function(n){return t.activated(n.Active),t.brandId=n.BrandId,ko.mapping.fromJS(n,{},t.initialData),t.registrationDate(n.DateRegistered),t.brand(n.Brand),t.currency(n.CurrencyCode),t.culture(n.Culture),$.ajax("PlayerManager/GetAddPlayerData").done(function(n){return ko.mapping.fromJS(n.data,{},t)}),$.ajax(u.adminApi("Brand/GetCountries"),{async:!1,data:{brandId:t.brandId},success:function(n){var i;return ko.mapping.fromJS(n.data,{},t),i=t.countries(),$.each(i,function(n,i){if(i.code()===t.initialData.CountryCode())return t.initialData.Country=ko.observable(i)})}}),$.ajax("PlayerManager/GetVipLevels?brandId="+t.brandId,{async:!1,success:function(n){var i;return ko.mapping.fromJS(n,{},t),i=ko.utils.arrayFirst(t.vipLevels(),function(n){return n.id()===t.initialData.VipLevel()}),t.vipLevel(i)}}),$.ajax("/PlayerInfo/GetPlayerTitle?id="+t.playerId()).done(function(n){return t.fullName(n.FirstName+" "+n.LastName),t.username(n.Username)}),$.ajax("PlayerManager/GetPaymentLevels?brandId="+t.brandId+"&currency="+t.currency(),{success:function(n){var i;return ko.mapping.fromJS(n,{},t),i=t.paymentLevels(),$.each(i,function(n,i){if(i.id()===t.initialData.PaymentLevel())return t.paymentLevel(i)}),t.setForm()}})})},f.prototype.setForm=function(){return this.firstName(this.initialData.FirstName()),this.lastName(this.initialData.LastName()),this.dateOfBirth(this.initialData.DateOfBirth()),this.title(this.initialData.Title()),this.gender(this.initialData.Gender()),this.email(this.initialData.Email()),this.phoneNumber(this.initialData.PhoneNumber()),this.mailingAddressLine1(this.initialData.MailingAddressLine1()),this.mailingAddressLine2(this.initialData.MailingAddressLine2()),this.mailingAddressLine3(this.initialData.MailingAddressLine3()),this.mailingAddressLine4(this.initialData.MailingAddressLine4()),this.mailingAddressCity(this.initialData.MailingAddressCity()),this.mailingAddressPostalCode(this.initialData.MailingAddressPostalCode()),this.physicalAddressLine1(this.initialData.PhysicalAddressLine1()),this.physicalAddressLine2(this.initialData.PhysicalAddressLine2()),this.physicalAddressLine3(this.initialData.PhysicalAddressLine3()),this.physicalAddressLine4(this.initialData.PhysicalAddressLine4()),this.physicalAddressCity(this.initialData.PhysicalAddressCity()),this.physicalAddressPostalCode(this.initialData.PhysicalAddressPostalCode()),this.country(this.initialData.Country()),this.contactPreference(this.initialData.ContactPreference()),this.accountAlertSms(this.initialData.AccountAlertSms()),this.accountAlertEmail(this.initialData.AccountAlertEmail()),this.marketingAlertSms(this.initialData.MarketingAlertSms()),this.marketingAlertEmail(this.initialData.MarketingAlertEmail()),this.marketingAlertPhone(this.initialData.MarketingAlertPhone()),this.securityQuestion(this.initialData.SecurityQuestion()),this.securityAnswer(this.initialData.SecurityAnswer())},f.prototype.edit=function(){return this.detailsEditMode(!0)},f.prototype.cancelEdit=function(){return this.setForm(),this.detailsEditMode(!1)},f.prototype.resendActivationEmail=function(){return $.ajax("/PlayerInfo/ResendActivationEmail?id="+this.playerId(),{type:"post",contentType:"application/json",success:function(n){return n.result==="success"?alert("Activation Email sent!"):alert("failed to resend activation email")}})},f.prototype.showSendMessageDialog=function(n){var i,r,u;return i=n.playerId,r="",u="Email",t.show(this,i,r,u)},f.prototype.setStatus=function(){var n;return n=this,$.ajax("/PlayerInfo/SetStatus?id="+n.playerId()+"&active="+!n.activated(),{type:"post",contentType:"application/json",success:function(t){return t.result==="success"?n.activated(t.active):alert("can't change status")}})},f.prototype.showChangeVipLevelDialog=function(n){var t,i,u,f,e;return u=n.playerId(),t=n.brand(),f=n.username(),i=n.vipLevelCode(),e=n.vipLevels,r.show(this,u,t,f,i,e)},f.prototype.clearEdit=function(){return this.firstName(""),this.lastName(""),this.email(""),this.phoneNumber(""),this.mailingAddressLine1(""),this.mailingAddressLine2(""),this.mailingAddressLine3(""),this.mailingAddressLine4(""),this.mailingAddressCity(""),this.mailingAddressPostalCode(""),this.physicalAddressLine1(""),this.physicalAddressLine2(""),this.physicalAddressLine3(""),this.physicalAddressLine4(""),this.physicalAddressCity(""),this.physicalAddressPostalCode(""),this.accountAlertSms(!1),this.accountAlertEmail(!1),this.marketingAlertSms(!1),this.marketingAlertEmail(!1),this.marketingAlertPhone(!1)},f.prototype.saveEdit=function(){var t,n;return n=this,$(n.uiElement).parent().hide().prev().show(),t={PlayerId:this.playerId,FirstName:this.firstName(),LastName:this.lastName(),DateOfBirth:this.dateOfBirth(),Title:this.title(),Gender:this.gender(),Email:this.email(),PhoneNumber:this.phoneNumber(),MailingAddressLine1:this.mailingAddressLine1(),MailingAddressLine2:this.mailingAddressLine2(),MailingAddressLine3:this.mailingAddressLine3(),MailingAddressLine4:this.mailingAddressLine4(),MailingAddressCity:this.mailingAddressCity(),MailingAddressPostalCode:this.mailingAddressPostalCode(),PhysicalAddressLine1:this.physicalAddressLine1(),PhysicalAddressLine2:this.physicalAddressLine2(),PhysicalAddressLine3:this.physicalAddressLine3(),PhysicalAddressLine4:this.physicalAddressLine4(),PhysicalAddressCity:this.physicalAddressCity(),PhysicalAddressPostalCode:this.physicalAddressPostalCode(),CountryCode:n.country().code,ContactPreference:this.contactPreference(),AccountAlertEmail:this.accountAlertEmail(),AccountAlertSms:this.accountAlertSms(),MarketingAlertEmail:this.marketingAlertEmail(),MarketingAlertSms:this.marketingAlertSms(),MarketingAlertPhone:this.marketingAlertPhone(),PaymentLevelId:this.paymentLevel().id},$.post("/PlayerInfo/Edit",t).done(function(i){return $(n.uiElement).parent().show().prev().hide(),i.result==="success"?(n.detailsEditMode(!1),i.data="app:players.updated",ko.mapping.fromJS(t,{},n.initialData),$("#player-grid").trigger("reload")):void 0})},f}()})}).call(this);
//# sourceMappingURL=account.min.js.map
