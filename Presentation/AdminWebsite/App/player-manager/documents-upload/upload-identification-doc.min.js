(function(){define(function(n){var i,t,u,r,f;return r=n("nav"),u=n("komapping"),t=n("i18next"),f=n("dateTimePicker"),i=function(){function n(){this.initializeViewModel()}return n.prototype.initializeViewModel=function(){var n;return this.SavePath="/PlayerInfo/UploadId",this.playerId=ko.observable(),this.message=ko.observable(),this.messageClass=ko.observable(),this.submitted=ko.observable(),this.licensee=ko.observable().extend({required:!0}),this.brand=ko.observable().extend({required:!0}),this.documentType=ko.observable().extend({required:!0}),this.username=ko.observable(),this.documentTypes=ko.observableArray(),this.isIdOrCredit=ko.computed(function(n){return function(){return n.documentType()==="Id"||n.documentType()==="CreditCard"}}(this)),this.firstFileUploaderLabel=ko.computed(function(n){return function(){var i;return(i=n.documentType(),i==="Id"||i==="CreditCard")?t.t("playerManager.identificationDocuments.labels.idFrontUpload"):"Upload Document"}}(this)),this.cardNumber=ko.observable().extend({minLength:1,maxLength:50,validation:{validator:function(){return function(n){return!/\s/.test(n)}}(this),message:t.t("admin.messages.whitespaces")}}),this.cardExpirationDate=ko.observable(),this.uploadId1FieldId=ko.observable("deposit-confirm-upload-id-1"),this.uploadId2FieldId=ko.observable("deposit-confirm-upload-id-2"),n="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIj48cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjE1MCIgeT0iMTAwIiBzdHlsZT0iZmlsbDojYWFhO2ZvbnQtd2VpZ2h0OmJvbGQ7Zm9udC1zaXplOjE5cHg7Zm9udC1mYW1pbHk6QXJpYWwsSGVsdmV0aWNhLHNhbnMtc2VyaWY7ZG9taW5hbnQtYmFzZWxpbmU6Y2VudHJhbCI+MzAweDIwMDwvdGV4dD48L3N2Zz4=",this.uploadId1Src=ko.observable(n),this.uploadId2Src=ko.observable(n),this.maxSize=4194304,this.idFrontImage=ko.observable().extend({required:!0,validation:{validator:function(n){return function(){var t,i;return t=$("input#"+n.uploadId1FieldId())[0],i=t?t.files[0]:void 0,i&&i.size<=n.maxSize}}(this),message:"Maximum file size is 4Mb."}}),this.idBackImage=ko.observable().extend({validation:{validator:function(n){return function(){var t,i;return(t=$("input#"+n.uploadId2FieldId())[0],i=t?t.files[0]:void 0,i===void 0)?!0:i.size<=n.maxSize}}(this),message:"Maximum file size is 4Mb."}}),this.remarks=ko.observable().extend({maxLength:200}),this.errors=ko.validation.group(this)},n.prototype.compositionComplete=function(){return $("input#"+this.uploadId1FieldId()).ace_file_input(this.makeFileInputSettings(this.idFrontImage)),$("input#"+this.uploadId2FieldId()).ace_file_input(this.makeFileInputSettings(this.idBackImage))},n.prototype.makeFileInputSettings=function(n){return{style:"well",btn_choose:"Drop image or click to choose",no_file:"No File ...",droppable:!0,thumbnail:"fit",before_change:function(i){var r,u;return r=i[0],typeof r=="string"?/\.(jpe?g|png|gif)$/i.test(r)||(n(""),alert(t.t("app:payment.deposit.pleaseSelectImage")),-1):(u=$.trim(r.type),(u.length>0&&!/^image\/(jpe?g|png|gif)$/i.test(u)||u.length===0&&!/\.(jpe?g|png|gif)$/i.test(r.name))&&(n(""),alert(t.t("app:payment.deposit.pleaseSelectImage")),-1)),!0}}},n.prototype.showError=function(n){return this.message(n),this.messageClass("alert alert-danger")},n.prototype.showMessage=function(n){return this.message(n),this.messageClass("alert alert-success")},n.prototype.clearMessage=function(){return this.message(""),this.messageClass("")},n.prototype.cancel=function(){return r.close()},n.prototype.clear=function(){return this.clearMessage(),this.licensee(""),this.licensee.isModified(!1),this.brand(""),this.brand.isModified(!1),this.documentType(""),this.documentType.isModified(!1),this.cardNumber(""),this.cardNumber.isModified(!1),this.cardExpirationDate(""),this.cardExpirationDate.isModified(!1),this.idFrontImage(""),this.idFrontImage.isModified(!1),this.idBackImage(""),this.idBackImage.isModified(!1),this.remarks(""),this.remarks.isModified(!1)},n.prototype.activate=function(n){return this.playerId(n.playerId),this.clear(),this.submitted(!1),this.load()},n.prototype.load=function(){return $.get("/PlayerInfo/GetIdentificationDocumentEditData?id="+this.playerId()).done(function(n){return function(t){return n.licensee(t.licenseeName),n.brand(t.brandName),n.username(t.username),n.documentTypes(t.documentTypes)}}(this))},n.prototype.save=function(){var n,i,t;return this.clearMessage(),this.isValid()?(i={documentType:this.documentType(),cardNumber:this.cardNumber(),cardExpirationDate:this.cardExpirationDate(),remarks:this.remarks()},t=new XMLHttpRequest,t.onreadystatechange=function(n){return function(){var i;if(4===t.readyState)return i=JSON.parse(t.responseText),i.result==="failed"?n.showError(i.data):($("#id-documents-grid").trigger("reload"),i.data.frontIdFilename&&n.uploadId1Src("image/Show?fileName="+i.data.frontIdFilename),i.data.backIdFilename&&n.uploadId2Src("image/Show?fileName="+i.data.backIdFilename),n.showMessage("Documents have been uploaded successfully."),n.submitted(!0)),$("input#"+n.uploadId1FieldId()).data().ace_file_input.disable(),$("input#"+n.uploadId2FieldId()).data().ace_file_input.disable()}}(this),t.open("post",this.SavePath,!0),n=new FormData,n.append("uploadId1",$("input#"+this.uploadId1FieldId())[0].files[0]),n.append("uploadId2",$("input#"+this.uploadId2FieldId())[0].files[0]),n.append("data",JSON.stringify(i)),n.append("playerId",this.playerId()),t.send(n)):this.errors.showAllMessages()},n}(),new i})}).call(this);
//# sourceMappingURL=upload-identification-doc.min.js.map
